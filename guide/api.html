<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API | FortuneSheet Document</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="FortuneSheet is a drop-in javascript spreadsheet library that provides rich features like Excel and Google Sheets. This site contains official configuration document, API, and tutorial.">
    
    <link rel="preload" href="/fortune-sheet-docs/assets/css/0.styles.30435712.css" as="style"><link rel="preload" href="/fortune-sheet-docs/assets/js/app.3ed2e04e.js" as="script"><link rel="preload" href="/fortune-sheet-docs/assets/js/2.47996c0d.js" as="script"><link rel="preload" href="/fortune-sheet-docs/assets/js/10.a35adacb.js" as="script"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/11.e5c63d06.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/12.e7f21874.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/13.ebaa0210.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/14.e3391312.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/15.20be9422.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/16.7a38910e.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/17.b655b15e.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/18.fb2d73f2.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/19.cb0d653f.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/20.576f513b.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/21.adddf67b.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/22.a15ca80e.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/23.701cdb8a.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/24.ded9d3f9.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/3.80c5e1b6.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/4.f2ea7168.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/5.7d2c18b0.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/6.c4567450.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/7.fd2b5dc4.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/8.f91a3d39.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/9.1d3cb3a5.js">
    <link rel="stylesheet" href="/fortune-sheet-docs/assets/css/0.styles.30435712.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/fortune-sheet-docs/" class="home-link router-link-active"><!----> <span class="site-name">FortuneSheet Document</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/fortune-sheet-docs/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/fortune-sheet-docs/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="https://ruilisi.github.io/fortune-sheet-demo/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Demo
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fortune-sheet-docs/guide/api.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/fortune-sheet-docs/zh/guide/api.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/ruilisi/fortune-sheet" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/fortune-sheet-docs/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/fortune-sheet-docs/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="https://ruilisi.github.io/fortune-sheet-demo/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Demo
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fortune-sheet-docs/guide/api.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/fortune-sheet-docs/zh/guide/api.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/ruilisi/fortune-sheet" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/fortune-sheet-docs/guide/" aria-current="page" class="sidebar-link">Get started</a></li><li><a href="/fortune-sheet-docs/guide/config.html" class="sidebar-link">Overall configuration</a></li><li><a href="/fortune-sheet-docs/guide/sheet.html" class="sidebar-link">Sheet Configuration</a></li><li><a href="/fortune-sheet-docs/guide/cell.html" class="sidebar-link">Format attributes</a></li><li><a href="/fortune-sheet-docs/guide/op.html" class="sidebar-link">Operation</a></li><li><a href="/fortune-sheet-docs/guide/api.html" aria-current="page" class="active sidebar-link">API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fortune-sheet-docs/guide/api.html#overview" class="sidebar-link">Overview</a></li></ul></li><li><a href="/fortune-sheet-docs/guide/FAQ.html" class="sidebar-link">FAQ</a></li><li><a href="/fortune-sheet-docs/guide/contribute.html" class="sidebar-link">Contribution guide</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="api"><a href="#api" class="header-anchor">#</a> API</h1> <p>API is avaible via the <code>ref</code> of <code>Workbook</code></p> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">const</span> ref <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useRef</span><span class="token generic class-name"><span class="token operator">&lt;</span>WorkbookInstance<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Workbook</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span></span> <span class="token attr-name">...</span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h2 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h2> <table><thead><tr><th>API</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="#applyop">applyOp</a></td> <td>Applys an array of op to the workbook</td></tr> <tr><td><a href="#getcellvalue">getCellValue</a></td> <td>Gets the value of a cell</td></tr> <tr><td><a href="#setcellvalue">setCellValue</a></td> <td>Sets the value of a cell</td></tr> <tr><td><a href="#clearcell">clearCell</a></td> <td>Clear the contents of the cell</td></tr> <tr><td><a href="#setcellformat">setCellFormat</a></td> <td>Sets the attributes of a cell</td></tr> <tr><td><a href="#freeze">freeze</a></td> <td>Freezes row and column</td></tr> <tr><td><a href="#insertroworcolumn">insertRowOrColumn</a></td> <td>Inserts rows or columns at specified position</td></tr> <tr><td><a href="#deleteroworcolumn">deleteRowOrColumn</a></td> <td>Deletes rows or columns at specified range</td></tr> <tr><td><a href="#getrowheight">getRowHeight</a></td> <td>Gets row heights in batch</td></tr> <tr><td><a href="#getcolumnwidth">getColumnWidth</a></td> <td>Gets column widths in batch</td></tr> <tr><td><a href="#setrowheight">setRowHeight</a></td> <td>Sets row heights in batch</td></tr> <tr><td><a href="#setcolumnwidth">setColumnWidth</a></td> <td>Sets column widths in batch</td></tr> <tr><td><a href="#getselection">getSelection</a></td> <td>Gets current selection</td></tr> <tr><td><a href="#getflattenrange">getFlattenRange</a></td> <td>Expands given range to cells coordinates</td></tr> <tr><td><a href="#getcellsbyflattenrange">getCellsByFlattenRange</a></td> <td>Maps cell coordinations to cell objects</td></tr> <tr><td><a href="#getselectioncoordinates">getSelectionCoordinates</a></td> <td>Gets a list of text representation of selection coordinates</td></tr> <tr><td><a href="#getcellsbyrange">getCellsByRange</a></td> <td>Maps range to cell objects</td></tr> <tr><td><a href="#gethtmlbyrange">getHtmlByRange</a></td> <td>Gets a html representation of the specified range</td></tr> <tr><td><a href="#setselection">setSelection</a></td> <td>Sets a selected range to the sheet</td></tr> <tr><td><a href="#setcellvaluesbyrange">setCellValuesByRange</a></td> <td>Like <code>setCellValue</code>, but set multiple cell values in one shot</td></tr> <tr><td><a href="#setcellformatbyrange">setCellFormatByRange</a></td> <td>Like <code>setCellFormat</code>, but set multiple cell formats in one shot</td></tr> <tr><td><a href="#mergecells">mergeCells</a></td> <td>Merges cells according to range and type</td></tr> <tr><td><a href="#cancelmerge">cancelMerge</a></td> <td>Cancels merge on a range</td></tr> <tr><td><a href="#getallsheets">getAllSheets</a></td> <td>Gets all sheets' raw data</td></tr> <tr><td><a href="#getsheet">getSheet</a></td> <td>Gets a sheet's raw data</td></tr> <tr><td><a href="#addsheet">addSheet</a></td> <td>Adds a new sheet to the workbook</td></tr> <tr><td><a href="#deletesheet">deleteSheet</a></td> <td>Deletes the specified sheet</td></tr> <tr><td><a href="#activatesheet">activateSheet</a></td> <td>Changes the current working sheet to the specified sheet</td></tr> <tr><td><a href="#setsheetname">setSheetName</a></td> <td>Sets the name of the specified sheet</td></tr> <tr><td><a href="#setsheetorder">setSheetOrder</a></td> <td>Sets the orders of the sheets</td></tr> <tr><td><a href="#scroll">scroll</a></td> <td>Scroll the current sheet to specified position</td></tr> <tr><td><a href="#addpresence">addPresence</a></td> <td>Add a collabrator presence</td></tr> <tr><td><a href="#removepresence">removePresence</a></td> <td>Removes a collabrator presence</td></tr></tbody></table> <hr> <h3 id="commonoptions"><a href="#commonoptions" class="header-anchor">#</a> CommonOptions</h3> <p>Many APIs has an optional <code>options</code> param in the end, it is mainly used for selecting sheet.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>index</td> <td>number</td> <td>index of sheet in the workbook</td></tr> <tr><td>id</td> <td>string</td> <td>id of sheet in the workbook, if index is set, this field does not take effect</td></tr></tbody></table> <hr> <h3 id="applyop"><a href="#applyop" class="header-anchor">#</a> applyOp</h3> <p><em>applyOp(ops)</em></p> <p>Applys an array of op to the workbook.</p> <p>This api is typically used in online collabration to sync data.</p> <p>See <a href="https://github.com/ruilisi/fortune-sheet/blob/master/stories/Collabration.stories.tsx" target="_blank" rel="noopener noreferrer">Collabration demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for an example usage.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>ops</td> <td>Op[]</td> <td>op list of current action</td></tr></tbody></table> <hr> <h3 id="getcellvalue"><a href="#getcellvalue" class="header-anchor">#</a> getCellValue</h3> <p><em>getCellValue(row, column, [options]) -&gt; any</em></p> <p>Gets the value of a cell.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>row</td> <td>number</td> <td>Row index</td></tr> <tr><td>column</td> <td>number</td> <td>Column index</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a> &amp; { type: string }</td> <td><code>type</code>: attribute of a Cell, default to 'v'</td></tr></tbody></table> <p><strong>Returns</strong> the specified field of a cell, if <code>options.type</code> is not set, returns the value of <code>v</code> of the Cell.</p> <hr> <h3 id="setcellvalue"><a href="#setcellvalue" class="header-anchor">#</a> setCellValue</h3> <p><em>setCellValue(row, column, value, [options])</em></p> <p>Sets the value of a cell.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>row</td> <td>number</td> <td>Row index</td></tr> <tr><td>column</td> <td>number</td> <td>Column index</td></tr> <tr><td>value</td> <td>any</td> <td>value to be set</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a> &amp; { type: string }</td> <td><code>type</code>: attribute of a Cell, default to 'v'</td></tr></tbody></table> <hr> <h3 id="clearcell"><a href="#clearcell" class="header-anchor">#</a> clearCell</h3> <p><em>clearCell(row, column, [options])</em></p> <p>Clear the contents of the cell.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>row</td> <td>number</td> <td>Row index</td></tr> <tr><td>column</td> <td>number</td> <td>Column index</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <hr> <h3 id="setcellformat"><a href="#setcellformat" class="header-anchor">#</a> setCellFormat</h3> <p><em>setCellFormat(row, column, attr, value, [options])</em></p> <p>Sets the attributes of a cell, such as font style and background.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>row</td> <td>number</td> <td>Row index</td></tr> <tr><td>column</td> <td>number</td> <td>Column index</td></tr> <tr><td>attr</td> <td>string</td> <td>attribute of cell</td></tr> <tr><td>value</td> <td>any</td> <td>value of <code>attr</code> to be set</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <hr> <h3 id="freeze"><a href="#freeze" class="header-anchor">#</a> freeze</h3> <p><em>freeze(type, range, [options])</em></p> <p>Freezes row and column.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>type</td> <td>string</td> <td>One of &quot;row&quot;, &quot;column&quot; or &quot;both&quot;</td></tr> <tr><td>range</td> <td>{ row: number, column: number }</td> <td><code>row</code>: row index to be freezed<br><code>column</code>: column index to be freezed</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <hr> <h3 id="insertroworcolumn"><a href="#insertroworcolumn" class="header-anchor">#</a> insertRowOrColumn</h3> <p><em>insertRowOrColumn(type, index, count, direction, [options])</em></p> <p>Inserts rows or columns at specified position.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>type</td> <td>string</td> <td>One of &quot;row&quot;, &quot;column&quot;</td></tr> <tr><td>index</td> <td>number</td> <td>The starting row or column index of insertion</td></tr> <tr><td>count</td> <td>number</td> <td>Amount of row or column to be inserted</td></tr> <tr><td>direction</td> <td>string</td> <td>One of 'lefttop' or 'rightbottom', default to 'rightbottom'.<br><code>lefttop</code>: insert row to the top of <code>index</code> row, or insert column to the left of <code>index</code> column.<br><code>rightbottom</code>: insert row to the bottom of <code>index</code> row, or insert column to the right of <code>index</code> column.</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <hr> <h3 id="deleteroworcolumn"><a href="#deleteroworcolumn" class="header-anchor">#</a> deleteRowOrColumn</h3> <p><em>deleteRowOrColumn(type, start, end, [options])</em></p> <p>Deletes rows or columns at specified range.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>type</td> <td>string</td> <td>One of &quot;row&quot;, &quot;column&quot;</td></tr> <tr><td>start</td> <td>number</td> <td>The starting row or column index to be deleted</td></tr> <tr><td>end</td> <td>number</td> <td>The ending row or column index to be deleted</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <p>--</p> <h3 id="getrowheight"><a href="#getrowheight" class="header-anchor">#</a> getRowHeight</h3> <p><em>getRowHeight(rows, [options])</em></p> <p>Gets row heights in batch.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>rows</td> <td>number[]</td> <td>A list of row indexes, e.g. [1, 4]</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <p><strong>Returns</strong> a map of specified row heights, e.g. { &quot;1&quot;: 150, &quot;4&quot;: 200 }</p> <hr> <h3 id="getcolumnwidth"><a href="#getcolumnwidth" class="header-anchor">#</a> getColumnWidth</h3> <p><em>getColumnWidth(columns, [options])</em></p> <p>Gets column widths in batch.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>columns</td> <td>number[]</td> <td>A list of column indexes, e.g. [1, 4]</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <p><strong>Returns</strong> a map of specified column widths, e.g. { &quot;1&quot;: 150, &quot;4&quot;: 200 }</p> <hr> <h3 id="setrowheight"><a href="#setrowheight" class="header-anchor">#</a> setRowHeight</h3> <p><em>setRowHeight(rowInfo, [options])</em></p> <p>Sets row heights in batch.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>rowInfo</td> <td>object</td> <td>A map in the form of [row index]: height.<br>Example: { &quot;1&quot;: 150, &quot;4&quot;: 200 } means setting height of row index 1 to 150 and height of row index 4 to 200</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <hr> <h3 id="setcolumnwidth"><a href="#setcolumnwidth" class="header-anchor">#</a> setColumnWidth</h3> <p><em>setColumnWidth(columnInfo, [options])</em></p> <p>Sets column widths in batch.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>columnInfo</td> <td>object</td> <td>A map in the form of [column index]: width.<br>Example: { &quot;1&quot;: 150, &quot;4&quot;: 200 } means setting width of column index 1 to 150 and width of column index 4 to 200</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <hr> <h3 id="getselection"><a href="#getselection" class="header-anchor">#</a> getSelection</h3> <p><em>getSelection()</em></p> <p>Gets current selection.</p> <p><strong>Returns</strong> an array of current selection.</p> <hr> <h3 id="getflattenrange"><a href="#getflattenrange" class="header-anchor">#</a> getFlattenRange</h3> <p><em>getFlattenRange(range)</em></p> <p>Expands given range to cells coordinates.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>range</td> <td>{ row: number[], column: number[] }</td> <td>A range object</td></tr></tbody></table> <p>Example:</p> <p>Input:</p> <div class="language- extra-class"><pre class="language-text"><code>{&quot;row&quot;: [0, 1], &quot;column&quot;: [0, 2]}
</code></pre></div><p>Output:</p> <div class="language- extra-class"><pre class="language-text"><code>[
	{&quot;r&quot;: 0, &quot;c&quot;: 0},
	{&quot;r&quot;: 0, &quot;c&quot;: 1},
	{&quot;r&quot;: 0, &quot;c&quot;: 2},
	{&quot;r&quot;: 1, &quot;c&quot;: 0},
	{&quot;r&quot;: 1, &quot;c&quot;: 1},
	{&quot;r&quot;: 1, &quot;c&quot;: 2},
]
</code></pre></div><hr> <h3 id="getcellsbyflattenrange"><a href="#getcellsbyflattenrange" class="header-anchor">#</a> getCellsByFlattenRange</h3> <p><em>getCellsByFlattenRange(range)</em></p> <p>Maps cell coordinations to cell objects.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>range</td> <td>{ r: number, c: number }[]</td> <td>A list of cell coordinations</td></tr></tbody></table> <p><strong>Returns</strong> A list of cell objects according to specified coordinations.</p> <hr> <h3 id="getselectioncoordinates"><a href="#getselectioncoordinates" class="header-anchor">#</a> getSelectionCoordinates</h3> <p><em>getSelectionCoordinates()</em></p> <p>Gets a list of text representation of selection coordinates.</p> <p>Example output:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span><span class="token string">&quot;E10:E14&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;A7:B13&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;A3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C6:D9&quot;</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="getcellsbyrange"><a href="#getcellsbyrange" class="header-anchor">#</a> getCellsByRange</h3> <p><em>getCellsByRange(range, [options])</em></p> <p>Maps range to cell objects.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>range</td> <td>{ row: number[], column: number[] }[]</td> <td>A list of ranges</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <p><strong>Returns</strong> A list of cell objects according to specified coordinations.</p> <hr> <h3 id="gethtmlbyrange"><a href="#gethtmlbyrange" class="header-anchor">#</a> getHtmlByRange</h3> <p><em>getHtmlByRange(range, [options])</em></p> <p>Gets a html representation of the specified range, typically used for pasting into other excel applications.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>range</td> <td>{ row: number[], column: number[] }[]</td> <td>A list of ranges</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <p><strong>Returns</strong> HTML string.</p> <hr> <h3 id="setselection"><a href="#setselection" class="header-anchor">#</a> setSelection</h3> <p><em>setSelection(range, [options])</em></p> <p>Sets a selected range to the sheet.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>range</td> <td>{ row: number[], column: number[] }</td> <td>A list of ranges</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <hr> <h3 id="setcellvaluesbyrange"><a href="#setcellvaluesbyrange" class="header-anchor">#</a> setCellValuesByRange</h3> <p><em>setCellValuesByRange(data, range, [options])</em></p> <p>Like <code>setCellValue</code>, but set multiple cell values in one shot.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>data</td> <td>any[][]</td> <td>two-dimension array of cell values</td></tr> <tr><td>range</td> <td>{ row: number[], column: number[] }</td> <td>range of cells to be set</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <p><strong>Note</strong>: size of <code>data</code> and <code>range</code> must be the same.</p> <hr> <h3 id="setcellformatbyrange"><a href="#setcellformatbyrange" class="header-anchor">#</a> setCellFormatByRange</h3> <p><em>setCellFormatByRange(attr, value, range, [options])</em></p> <p>Like <code>setCellFormat</code>, but set multiple cell formats in one shot.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>attr</td> <td>string</td> <td>attribute of cell</td></tr> <tr><td>value</td> <td>any</td> <td>value of <code>attr</code> to be set</td></tr> <tr><td>range</td> <td>{ row: number[], column: number[] }</td> <td>range of cells to be set</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <hr> <h3 id="mergecells"><a href="#mergecells" class="header-anchor">#</a> mergeCells</h3> <p><em>mergeCells(ranges, type, [options])</em></p> <p>Merges cells according to range and type.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>ranges</td> <td>{ row: number[], column: number[] }[]</td> <td>list of ranges of cells to be merged</td></tr> <tr><td>type</td> <td>string</td> <td>One of &quot;merge-all&quot;, &quot;merge-horizontal&quot;, &quot;merge-vertical&quot;</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <hr> <h3 id="cancelmerge"><a href="#cancelmerge" class="header-anchor">#</a> cancelMerge</h3> <p><em>cancelMerge(ranges, [options])</em></p> <p>Cancels merge on a range.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>ranges</td> <td>{ row: number[], column: number[] }[]</td> <td>list of ranges of cells to be canceled</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <hr> <h3 id="getallsheets"><a href="#getallsheets" class="header-anchor">#</a> getAllSheets</h3> <p><em>getAllSheets()</em></p> <p><strong>Returns</strong> all sheets' raw data.</p> <hr> <h3 id="getsheet"><a href="#getsheet" class="header-anchor">#</a> getSheet</h3> <p><em>getSheet(options)</em></p> <p>Gets a sheet's raw data.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <p><strong>Returns</strong> a single sheet's raw data.</p> <hr> <h3 id="addsheet"><a href="#addsheet" class="header-anchor">#</a> addSheet</h3> <p><em>addSheet()</em></p> <p>Adds a new sheet to the workbook.</p> <hr> <h3 id="deletesheet"><a href="#deletesheet" class="header-anchor">#</a> deleteSheet</h3> <p><em>deleteSheet(options)</em></p> <p>Deletes the specified sheet.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <hr> <h3 id="activatesheet"><a href="#activatesheet" class="header-anchor">#</a> activateSheet</h3> <p><em>activateSheet(options)</em></p> <p>Changes the current working sheet to the specified sheet.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <hr> <h3 id="setsheetname"><a href="#setsheetname" class="header-anchor">#</a> setSheetName</h3> <p><em>setSheetName(options)</em></p> <p>Sets the name of the specified sheet.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>common options</td></tr></tbody></table> <hr> <h3 id="setsheetorder"><a href="#setsheetorder" class="header-anchor">#</a> setSheetOrder</h3> <p><em>setSheetOrder(orderList)</em></p> <p>Sets the orders of the sheets.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>orderList</td> <td>object</td> <td>a map of key: sheet id, value: order number</td></tr></tbody></table> <p>Example input:</p> <div class="language-json extra-class"><pre class="language-json"><code>
<span class="token punctuation">{</span>
	<span class="token property">&quot;id_of_sheet_1&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token property">&quot;id_of_sheet_2&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">&quot;id_of_sheet_3&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Note</strong>: This api will reorder all sheets starting from 0. So, you can just specify the sheet you want to <strong>move</strong>, by setting a <strong>middle</strong> order number. For example, assume current sheet order is:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;id_of_sheet_1&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">&quot;id_of_sheet_2&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token property">&quot;id_of_sheet_3&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You want <code>id_of_sheet_3</code> to be moved between <code>id_of_sheet_1</code> and <code>id_of_sheet_2</code>, then call this API with:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;id_of_sheet_3&quot;</span><span class="token operator">:</span> <span class="token number">0.5</span>
<span class="token punctuation">}</span>
</code></pre></div><p>And the resulting order number will be:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;id_of_sheet_1&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">&quot;id_of_sheet_3&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token property">&quot;id_of_sheet_2&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <h3 id="scroll"><a href="#scroll" class="header-anchor">#</a> scroll</h3> <p><em>scroll(options)</em></p> <p>Scroll the current sheet to specified position.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>options</td> <td>{ scrollLeft?: number, scrollTop?: number, targetRow?: number, targetColumn?: number }</td> <td>position to be scrolled, all four params are optional</td></tr></tbody></table> <hr> <h3 id="addpresence"><a href="#addpresence" class="header-anchor">#</a> addPresence</h3> <p><em>addPresence(presence)</em></p> <p>Add a collabrator presence, the collabrator's focusing cell will be shown.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>presence</td> <td>Presence</td> <td>a Presence object</td></tr></tbody></table> <p>The <code>Presence</code> object:</p> <table><thead><tr><th>Field</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>sheetId</td> <td>string</td> <td>id of the sheet</td></tr> <tr><td>username</td> <td>string</td> <td>username to be shown on the sheet</td></tr> <tr><td>userId</td> <td>string</td> <td>(optional) user id to be used for comparison, if not set, uses <code>username</code></td></tr> <tr><td>color</td> <td>string</td> <td>color of the focusing rect</td></tr> <tr><td>selection</td> <td>{ r: number, c: number }</td> <td>position of the focusing rect</td></tr></tbody></table> <hr> <h3 id="removepresence"><a href="#removepresence" class="header-anchor">#</a> removePresence</h3> <p><em>removePresence(presence)</em></p> <p>Removes a collabrator presence.</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>presence</td> <td>Presence</td> <td>a Presence object, see <a href="#addpresence">addPresence</a>, but only <code>username</code> or <code>userId</code> is required</td></tr></tbody></table></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ruilisi/fortune-sheet/edit/master/docs/guide/api.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/11/2022, 2:27:37 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/fortune-sheet-docs/guide/op.html" class="prev">
        Operation
      </a></span> <span class="next"><a href="/fortune-sheet-docs/guide/FAQ.html">
        FAQ
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/fortune-sheet-docs/assets/js/app.3ed2e04e.js" defer></script><script src="/fortune-sheet-docs/assets/js/2.47996c0d.js" defer></script><script src="/fortune-sheet-docs/assets/js/10.a35adacb.js" defer></script>
  </body>
</html>
