(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{429:function(t,s,a){"use strict";a.r(s);var e=a(35),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#操作"}},[t._v("#")]),t._v(" 操作")]),t._v(" "),a("p",[t._v("每当用户在表格上做操作，一个"),a("code",[t._v("Op")]),t._v("列表会通过"),a("code",[t._v("onOp")]),t._v("回调发出。op描述了如何从当前数据修改为用户操作后的新数据的步骤。例如，当用户在A2单元格上设置了加粗，生成的op如下：")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"op"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"replace"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"path"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bl"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"value"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("op对后端数据修改和同步在线协同数据非常有用。")]),t._v(" "),a("p",[t._v("我们在 "),a("code",[t._v("backend-demo")]),t._v(" 目录中展示了一个例子，使用 "),a("code",[t._v("Express")]),t._v(" (后端) and "),a("code",[t._v("MongoDB")]),t._v(" (数据库) 实现。")]),t._v(" "),a("p",[t._v("通过 "),a("code",[t._v("node index.js")]),t._v(" 运行后端服务器，然后访问 "),a("a",{attrs:{href:"https://ruilisi.github.io/fortune-sheet-demo/?path=/story/collabration--example",target:"_blank",rel:"noopener noreferrer"}},[t._v("Collabration example"),a("OutboundLink")],1),t._v(" 即可体验。")]),t._v(" "),a("blockquote",[a("p",[t._v("可通过 http://localhost:8081/init 初始化数据")])]),t._v(" "),a("h2",{attrs:{id:"格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#格式"}},[t._v("#")]),t._v(" 格式")]),t._v(" "),a("p",[t._v("每个 "),a("code",[t._v("Op")]),t._v(" 的格式如下")]),t._v(" "),a("div",{staticClass:"language-ts extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"op"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"path"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("any")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"value"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("any")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("其中")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("键")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("op")]),t._v(" "),a("td",[t._v("操作名, 应为 "),a("code",[t._v("add")]),t._v(", "),a("code",[t._v("remove")]),t._v(", "),a("code",[t._v("replce")]),t._v(", "),a("code",[t._v("insertRowCol")]),t._v(", "),a("code",[t._v("deleteRowCol")]),t._v(", "),a("code",[t._v("addSheet")]),t._v(", "),a("code",[t._v("deleteSheet")]),t._v(" 其中之一")])]),t._v(" "),a("tr",[a("td",[t._v("id")]),t._v(" "),a("td",[t._v("当前Sheet的id")])]),t._v(" "),a("tr",[a("td",[t._v("path")]),t._v(" "),a("td",[t._v("要更新数据的路径")])]),t._v(" "),a("tr",[a("td",[t._v("value")]),t._v(" "),a("td",[t._v("更新的数据")])])])]),t._v(" "),a("h2",{attrs:{id:"操作名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#操作名"}},[t._v("#")]),t._v(" 操作名")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("名称")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("add")]),t._v(" "),a("td",[t._v("在path添加值")])]),t._v(" "),a("tr",[a("td",[t._v("replace")]),t._v(" "),a("td",[t._v("在path替换值")])]),t._v(" "),a("tr",[a("td",[t._v("remove")]),t._v(" "),a("td",[t._v("在path删除值")])]),t._v(" "),a("tr",[a("td",[t._v("insertRowCol")]),t._v(" "),a("td",[t._v("特殊op, 查看 "),a("a",{attrs:{href:"#insertrowcol"}},[t._v("insertRowCol")])])]),t._v(" "),a("tr",[a("td",[t._v("deleteRowCol")]),t._v(" "),a("td",[t._v("特殊op, 查看 "),a("a",{attrs:{href:"#deleterowcol"}},[t._v("deleteRowCol")])])]),t._v(" "),a("tr",[a("td",[t._v("addSheet")]),t._v(" "),a("td",[t._v("特殊op, 查看 "),a("a",{attrs:{href:"#addsheet"}},[t._v("addSheet")])])]),t._v(" "),a("tr",[a("td",[t._v("deleteSheet")]),t._v(" "),a("td",[t._v("特殊op, 查看 "),a("a",{attrs:{href:"#deletesheet"}},[t._v("deleteSheet")])])])])]),t._v(" "),a("h2",{attrs:{id:"特殊op"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#特殊op"}},[t._v("#")]),t._v(" 特殊op")]),t._v(" "),a("p",[t._v("特殊op是一些无法用 "),a("code",[t._v("add")]),t._v(", "),a("code",[t._v("replace")]),t._v(" 或 "),a("code",[t._v("remove")]),t._v(" 表达的操作, 因为用它们表达产生的op过大, 不适合作为op使用.")]),t._v(" "),a("h3",{attrs:{id:"insertrowcol"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#insertrowcol"}},[t._v("#")]),t._v(" insertRowCol")]),t._v(" "),a("p",[t._v("代表用户做了插入行列操作。")]),t._v(" "),a("p",[t._v("此时 "),a("code",[t._v("value")]),t._v(" 的格式为:")]),t._v(" "),a("div",{staticClass:"language-ts extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"row"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"column"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  index"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("number")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  count"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("number")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  direction"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lefttop"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rightbottom"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("where")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("名称")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("type")]),t._v(" "),a("td",[a("code",[t._v("row")]),t._v(" 或 "),a("code",[t._v("column")])])]),t._v(" "),a("tr",[a("td",[t._v("index")]),t._v(" "),a("td",[t._v("要插入行列的起始位置")])]),t._v(" "),a("tr",[a("td",[t._v("count")]),t._v(" "),a("td",[t._v("插入的数量")])]),t._v(" "),a("tr",[a("td",[t._v("direction")]),t._v(" "),a("td",[t._v("插入的方向，"),a("code",[t._v("lefttop")]),t._v(" 或 "),a("code",[t._v("rightbottom")])])]),t._v(" "),a("tr",[a("td",[t._v("id")]),t._v(" "),a("td",[t._v("当前操作表格的id")])])])]),t._v(" "),a("h3",{attrs:{id:"deleterowcol"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deleterowcol"}},[t._v("#")]),t._v(" deleteRowCol")]),t._v(" "),a("p",[t._v("代表用户做了删除行列操作。")]),t._v(" "),a("p",[t._v("此时 "),a("code",[t._v("value")]),t._v(" 的格式为:")]),t._v(" "),a("div",{staticClass:"language-ts extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"row"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"column"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  start"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("number")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  end"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("number")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("其中")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("名称")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("type")]),t._v(" "),a("td",[a("code",[t._v("row")]),t._v(" 或 "),a("code",[t._v("column")])])]),t._v(" "),a("tr",[a("td",[t._v("start")]),t._v(" "),a("td",[t._v("删除行列的起始位置")])]),t._v(" "),a("tr",[a("td",[t._v("end")]),t._v(" "),a("td",[t._v("删除行列的终止位置")])]),t._v(" "),a("tr",[a("td",[t._v("id")]),t._v(" "),a("td",[t._v("当前操作表格的id")])])])]),t._v(" "),a("h3",{attrs:{id:"addsheet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#addsheet"}},[t._v("#")]),t._v(" addSheet")]),t._v(" "),a("p",[t._v("代表用户做了新增表格操作。")]),t._v(" "),a("p",[t._v("此时 "),a("code",[t._v("value")]),t._v(" 是新表格的完整数据。")]),t._v(" "),a("h3",{attrs:{id:"deletesheet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deletesheet"}},[t._v("#")]),t._v(" deleteSheet")]),t._v(" "),a("p",[t._v("代表用户做了删除表格操作。")]),t._v(" "),a("p",[t._v("此时 "),a("code",[t._v("value")]),t._v(" 的格式为:")]),t._v(" "),a("div",{staticClass:"language-ts extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("其中")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("名称")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("id")]),t._v(" "),a("td",[t._v("要删除的表格id")])])])])])}),[],!1,null,null,null);s.default=r.exports}}]);